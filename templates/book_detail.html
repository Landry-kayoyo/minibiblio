{% extends 'base.html' %}
{% block title %}{{ book.title }} | Mini Bibliothèque{% endblock %}
{% block content %}
<!-- Book Detail Section with Breadcrumb -->
<section class="py-5 bg-light">
  <div class="container">
    <nav aria-label="breadcrumb" class="mb-4">
      <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'home' %}">Accueil</a></li>
        <li class="breadcrumb-item"><a href="{% url 'books_list' %}">Catalogue</a></li>
        <li class="breadcrumb-item active" aria-current="page">{{ book.title|truncatewords:3 }}</li>
      </ol>
    </nav>
   
    <div class="row g-4 g-lg-5">
      <!-- Book Cover Column -->
      <div class="col-lg-4 col-xl-3">
        <div class="sticky-top" style="top: 80px;">
          <div class="card border-0 shadow-sm">
            <div class="card-body p-4 text-center">
              <img src="{{ book.cover.url }}"
                   class="img-fluid rounded shadow mb-3"
                   alt="{{ book.title }}"
                   style="max-height: 360px; width: auto;">
             
              <div class="d-grid gap-3">
                {% if book.file %}
                <a href="{{ book.file.url }}"
                   class="btn btn-primary btn-lg py-3 d-flex align-items-center justify-content-center"
                   download>
                  <i class="fas fa-file-pdf me-3 fs-4"></i>
                  <span>Télécharger PDF</span>
                </a>
                {% endif %}
               
                <div class="d-flex gap-2">
                  <a href="{% url 'books_list' %}" class="btn btn-outline-secondary flex-grow-1">
                    <i class="fas fa-arrow-left me-2"></i>Retour
                  </a>
                  <button class="btn btn-outline-secondary" data-bs-toggle="modal" data-bs-target="#shareModal">
                    <i class="fas fa-share-alt"></i>
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Book Content Column -->
      <div class="col-lg-8 col-xl-9">
        <div class="card border-0 shadow-sm">
          <div class="card-body p-4 p-lg-5">
            <!-- Book Header -->
            <div class="mb-4 pb-3 border-bottom">
              <div class="d-flex justify-content-between align-items-start">
                <div>
                  <h1 class="display-6 fw-bold text-dark mb-2">{{ book.title }}</h1>
                  <h2 class="h4 text-muted mb-3">par {{ book.author }}</h2>
                </div>
                <span class="badge bg-primary bg-opacity-10 text-primary fs-6 px-3 py-2 rounded-pill">
                  {{ book.category.name }}
                </span>
              </div>
             
              <div class="d-flex flex-wrap gap-2 mt-3">
                <span class="badge bg-light text-dark py-2 px-3">
                  <i class="fas fa-calendar-day text-primary me-2"></i>
                  Publié en {{ book.publication_date|date:"Y" }}
                </span>
                {% if book.pages %}
                <span class="badge bg-light text-dark py-2 px-3">
                  <i class="fas fa-file-alt text-primary me-2"></i>
                  {{ book.pages }} pages
                </span>
                {% endif %}
                {% if book.isbn %}
                <span class="badge bg-light text-dark py-2 px-3">
                  <i class="fas fa-barcode text-primary me-2"></i>
                  ISBN: {{ book.isbn }}
                </span>
                {% endif %}
              </div>
            </div>
            <!-- Book Description -->
            <div class="mb-5">
              <h3 class="h5 fw-bold text-dark mb-3">Synopsis</h3>
              <div class="text-dark lh-lg fs-5" style="text-align: justify;">
                {{ book.description|linebreaks }}
              </div>
            </div>
            <!-- Book Preview -->
            {% if book.file %}
            <div class="mt-5 pt-4 border-top">
              <div class="d-flex flex-wrap justify-content-between align-items-center mb-4">
                <h3 class="h5 fw-bold text-dark mb-3 mb-sm-0">Aperçu interactif</h3>
                <div class="d-flex gap-2">
                  <a href="{{ book.file.url }}"
                     class="btn btn-outline-primary btn-sm"
                     target="_blank">
                    <i class="fas fa-expand me-1"></i>Plein écran
                  </a>
                  <a href="{{ book.file.url }}"
                     class="btn btn-outline-primary btn-sm"
                     download>
                    <i class="fas fa-download me-1"></i>Télécharger
                  </a>
                </div>
              </div>
             
              <div class="ratio ratio-16x9 border rounded-3 overflow-hidden shadow-sm bg-light">
                <iframe src="{{ book.file.url }}#toolbar=0&view=fitH"
                        class="w-100 h-100"
                        allowfullscreen
                        loading="lazy"></iframe>
              </div>
             
              <div class="alert alert-info mt-3 d-flex align-items-center">
                <i class="fas fa-info-circle me-2 fs-5"></i>
                <div>
                  <strong>Astuce :</strong> Utilisez les touches fléchées ou les contrôles pour naviguer dans l'aperçu
                </div>
              </div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- Share Modal -->
<div class="modal fade" id="shareModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Partager ce livre</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="d-flex justify-content-center gap-3 py-3">
          <a href="#" class="btn btn-outline-primary rounded-circle p-3">
            <i class="fab fa-facebook-f fs-5"></i>
          </a>
          <a href="#" class="btn btn-outline-info rounded-circle p-3">
            <i class="fab fa-twitter fs-5"></i>
          </a>
          <a href="#" class="btn btn-outline-danger rounded-circle p-3">
            <i class="fab fa-whatsapp fs-5"></i>
          </a>
          <a href="#" class="btn btn-outline-secondary rounded-circle p-3">
            <i class="fas fa-envelope fs-5"></i>
          </a>
        </div>
        <div class="input-group mb-3">
          <input type="text" class="form-control" value="{{ request.build_absolute_uri }}" readonly>
          <button class="btn btn-primary" onclick="copyToClipboard()">
            <i class="fas fa-copy me-1"></i>Copier
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}